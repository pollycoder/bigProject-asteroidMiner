# 航天动力学大作业

## 1. 题目信息解读

#### (1) 优化指标和优化变量

- 优化指标：终端干重相反数$-m_f$

- 优化变量：
  手动调整：关键节点序列（总飞行策略）
  优化器调整：各关键节点的时间$t_i$

生成步骤：先生成关键节点序列（主要是确定借力的节点），然后优化时间序列

#### (2) 约束

- 最小借力高度：

$$
r_p\geq 300 km
$$

- 几个轨道交点的要求：
1. 小行星：交会（采矿过程）
2. 火星：借力（脉冲等效模型，鉴于多数计算结果都是借力后加脉冲更好，目前统一设置成辅助后加脉冲）
3. 最长出发窗口：1825天（5年）
   最长任务总时间：5475天（15年）
4. 最大剩余速度4m/s，否则加脉冲
5. 燃料只有500kg，中间任何一次脉冲时发现烧光都必须终止。<font color=yellow>可行性的预测：先进行剩余燃料的优化，$J=-m_{fuel}$，如果指标最终优化结果可以达到负数，证明可行（时间序列已经加过惩罚），然后再进行采样质量的优化（先保证可行，再保证采样）。</font>

### (3) 已知量

轨道根数：已经保存在.mat文件中

单位换算：已经保存在.mat文件中
不过发现用全局会有Bug，所以还是老老实实c+v进优化函数

    单位换算关系：
    时间：年，为了减少优化计算量
    长度：AU，以地球公转轨道半长轴为准
    
    速度、引力系数单位：用时间、长度重新换算
    
    轨道根数换算：封装成了一个数组，除了半长轴使用长度单位换算，其他全部置1
    
    g=9.80665$m/s^2$

比冲：3000s

初始干重：500kg

燃料：共500kg

## 2. 方案生成

### 11.26 最简方案

#### 方案概述：去时借力一次，回时借力一次，只采一次

如何获取优化指标：

1. 直接给采样质量撒点。如果燃料发现不足，给惩罚（指标为负，给个正数就行，比如1）

2. 先进行脉冲优化，取总脉冲量最小的一种，然后计算最大能采多少（比较粗略，可以先比结果）

#### 问题分析：

1. 质量变化：第一次借力前只用算总重，鉴于比冲很大，一次脉冲量级约在$5\sim 7*10^3m/s$以下，所以脉冲一次花掉的燃料占据总重大约为

$$
1-e^{-\frac{1}{3}}\approx 15.3%
$$

这个质量消耗还是相当大的，以初始干重霍曼转移为例，会花掉总重近20%质量的燃料，相当于30~40%的燃料。如果要去Psyche，不借力连到达都成问题。

2. 如果满燃料返回能装多少？

假设我们上火星借力一次回了地球，那么以$10^4m/s$来估算，花掉的燃料占据总重的28.3%，那么燃料就占总重的28.3%，也就是大概能采770kg的小行星。之后计算的结果应该和这个值在同一量级。

3. 时间分析：

出发窗口是5年，我们知道地火借力的等待周期是777.9天，约为两年多一点，而火星周期是2年。所以等待借力时机足够用，最好能在两年内出发，为多次借力（主要是共振借力，后续方案改进可能会用）留下时间。

总的任务时间是15年。小行星的半长轴约为地球的3倍，周期就是大约5.2年，也就是采样后返回的速度要快，不能等，除非使用循环轨道，多次采样，但是也要采完后立刻返回。

共振轨道最好周期是火星的两倍，再多时间就超过了。

#### 优化变量：（事件序列-变量名）

（注：以下变量除了质量外全部采用新单位计算）

| 1   | 从地球出发，脉冲         | $t_0$                             |
| --- | ---------------- | --------------------------------- |
| 6   | 第一次火星借力，前往小行星，脉冲 | $t_1$,$r_{p_1}$, $\phi_1$         |
| 2   | 到达小行星，交会，脉冲      | $t_2$ |
| 3   | 采样，质量瞬间变化        | $m_f$                             |
| 4   | 从小行星返航，脉冲        | $t_3$                             |
| 6   | 第二次火星借力，回地球，脉冲   | $t_4$,$r_{p_2}$,$\phi_2$          |
| 5   | 到达地球，脉冲          | $t_5$                             |

优化变量序列：$[t_1, t_2, t_3, t_4, t_5, r_{p_1},r_{p_2},\phi_1, \phi_2, m_f]$

### 目前结果

<font color=red>约束不行，主要是回程燃料不足。</font>

去Psyche就要花掉60%的燃料，回程瞄准火星借力加的脉冲太大，导致借力之后没燃料回地球了。。。。

该方案目前还在优化燃料中，但目前来看燃料约束似乎很难达到。。。。。
